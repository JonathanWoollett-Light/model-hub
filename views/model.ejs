<html>
  <head>
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <script nomodule src="https://unpkg.com/@google/model-viewer/dist/model-viewer-legacy.js"></script>
  </head>
  <body>
    <h1><%= model.title %></h1>
    <p><%= model.desc %></p>

    <!-- TODO Figure out how to best render versions -->
    
    <table>
      <tr>
        <th>Model</th>
        <th>Date</th>
        <th>Description</th>
      </tr>
      <% for(let i=model.versions.length-1;i>=0; i--) { %>
        <tr>
          <!-- TODO Make this size change work -->
          <td><model-viewer width="1000", height="1000", src="data:application/octet-stream;base64,<%= model.versions[i].file.data.buffer.toString('base64') %>" auto-rotate camera-controls></model-viewer></td>
          <td><%= model.versions[i].date %></td>
          <th><%= model.versions[i].desc %></th>
        </tr>
      <% } %>
    </table>
    
    <form action="/models/<%= model._id %>/version" method="post" enctype="multipart/form-data">
      <label for="desc">Desc</label>
      <input type="text" id="desc" name="desc" required>
      <label for="file">File</label>
      <input type="file" id="file" name="file" required>
      <button type="submit">New version</button>
  </form>

    <form action="/models/<%= model._id %>/shareOwnership?_method=PUT" method="post">
        <label for="email">Email</label>
        <input type="email" id="email" name="email" required>
        <button type="submit">Share ownership</button>
    </form>
    <form action="/models/<%= model._id %>/disown?_method=DELETE" method="post">
        <button type="submit">Disown</button>
    </form>

    <form action="/logout?_method=DELETE" method="post">
      <button type="submit">Log Out</button>
    </form>
  </body>
</html>